import{m as i,C as s,h as u,T as r,d as w,M as f,a as m}from"./index.b2caa09a.js";function c(e){let n=new DOMParser().parseFromString(e,"text/html");return n.querySelectorAll('a[href*="://"]').forEach(o=>{o.setAttribute("target","_blank")}),n.documentElement.outerHTML}window.Alpine=i;i.store("challenge",{data:{view:""}});i.data("Hint",()=>({id:null,html:null,async showHint(e){if(e.target.open){let t=await s.pages.challenge.loadHint(this.id);if(t.errors){e.target.open=!1,s._functions.challenge.displayUnlockError(t);return}let n=t.data;if(n.content)this.html=c(n.html);else if(await s.pages.challenge.displayUnlock(this.id)){let o=await s.pages.challenge.loadUnlock(this.id);if(o.success){let l=(await s.pages.challenge.loadHint(this.id)).data;this.html=c(l.html)}else e.target.open=!1,s._functions.challenge.displayUnlockError(o)}else e.target.open=!1}}}));i.data("Challenge",()=>({id:null,next_id:null,submission:"",tab:null,solves:[],submissions:[],solution:null,response:null,share_url:null,max_attempts:0,attempts:0,ratingValue:0,selectedRating:0,ratingReview:"",ratingSubmitted:!1,async init(){u()},getStyles(){let e={"modal-dialog":!0};try{switch(s.config.themeSettings.challenge_window_size){case"sm":e["modal-sm"]=!0;break;case"lg":e["modal-lg"]=!0;break;case"xl":e["modal-xl"]=!0;break;default:break}}catch(t){console.log("Error processing challenge_window_size"),console.log(t)}return e},async init(){u()},async showChallenge(){new r(this.$el).show()},async showSolves(){this.solves=await s.pages.challenge.loadSolves(this.id),this.solves.forEach(e=>(e.date=w(e.date).format("MMMM Do, h:mm:ss A"),e)),new r(this.$el).show()},async showSubmissions(){let e=await s.pages.users.userSubmissions("me",this.id);this.submissions=e.data,this.submissions.forEach(t=>(t.date=w(t.date).format("MMMM Do, h:mm:ss A"),t)),new r(this.$el).show()},getSolutionId(){return i.store("challenge").data.solution_id},getSolutionState(){return i.store("challenge").data.solution_state},setSolutionId(e){i.store("challenge").data.solution_id=e},async showSolution(){let e=this.getSolutionId();s._functions.challenge.displaySolution=t=>{this.solution=t.html,new r(this.$el).show()},await s.pages.challenge.displaySolution(e)},getNextId(){return i.store("challenge").data.next_id},async nextChallenge(){let e=f.getOrCreateInstance("[x-ref='challengeWindow']");e._element.addEventListener("hidden.bs.modal",t=>{i.nextTick(()=>{this.$dispatch("load-challenge",this.getNextId())})},{once:!0}),e.hide()},async getShareUrl(){let e={type:"solve",challenge_id:this.id};const a=(await(await s.fetch("/api/v1/shares",{method:"POST",body:JSON.stringify(e)})).json()).data.url;this.share_url=a},copyShareUrl(){navigator.clipboard.writeText(this.share_url);let e=m.getOrCreateInstance(this.$el);e.enable(),e.show(),setTimeout(()=>{e.hide(),e.disable()},2e3)},async submitChallenge(){this.response=await s.pages.challenge.submitChallenge(this.id,this.submission),await this.renderSubmissionResponse()},async renderSubmissionResponse(){if(this.response.data.status==="correct"&&(this.submission=""),this.getSolutionId()==null&&s.pages.challenge.checkSolution(this.getSolutionState(),i.store("challenge").data,this.response.data.status)){let e=await s.pages.challenge.getSolution(this.id);this.setSolutionId(e.id)}this.max_attempts>0&&this.response.data.status!="already_solved"&&this.response.data.status!="ratelimited"&&(this.attempts+=1),this.$dispatch("load-challenges")},async submitRating(){(await s.pages.challenge.submitRating(this.id,this.selectedRating,this.ratingReview)).value?(this.ratingValue=this.selectedRating,this.ratingSubmitted=!0):alert("Error submitting rating")}}));i.data("ChallengeBoard",()=>({loaded:!1,challenges:[],challenge:null,async init(){if((window.init.themeSettings===void 0||window.init.themeSettings==null)&&(window.init.themeSettings={}),window.init.themeSettings.yearOfCalendar===void 0&&(window.init.themeSettings.yearOfCalendar="2026"),window.init.themeSettings.monthOfCalendar===void 0&&(window.init.themeSettings.monthOfCalendar="12"),window.init.themeSettings.lastDayOfCalendar===void 0&&(window.init.themeSettings.lastDayOfCalendar="24"),window.init.themeSettings.challOnWE===void 0&&(window.init.themeSettings.challOnWE="false"),window.init.themeSettings.calendarMessage===void 0&&(window.init.themeSettings.calendarMessage=""),this.challenges=await s.pages.challenges.getChallenges(),this.loaded=!0,window.location.hash){let e=decodeURIComponent(window.location.hash.substring(1)),t=e.lastIndexOf("-");if(t>=0){let a=[e.slice(0,t),e.slice(t+1)][1];await this.loadChallenge(a)}}},getChallengesByDay(){const e=[];for(let t of this.challenges)for(let n of t.tags)if(n.value.startsWith("day-")){const a=parseInt(n.value.substr(4,2));e[a]=t}return e},getExtraChallenges(){const e=[];for(let t of this.challenges)for(let n of t.tags)if(n.value=="extra"){e.push(t);break}return e},hasExtraChallenges(){for(let e of this.challenges)for(let t of e.tags)if(t.value=="extra")return!0;return!1},generateCalendar(){const e=[],t=new Date(window.init.themeSettings.yearOfCalendar,window.init.themeSettings.monthOfCalendar-1,1).getDay(),n=new Date(window.init.themeSettings.yearOfCalendar,window.init.themeSettings.monthOfCalendar,0).getDate();t==0&&(t=7);var a=1;const o=this.getChallengesByDay(),d=[];for(let l=1;l<8;l++)if(l<t)d.push({status:"NOT_CALENDAR_MONTH"});else if(l>5&&window.init.themeSettings.challOnWE=="false")d.push({status:"NO_CHALL_WE",date:a}),a++;else{const h={status:"CHALL",date:a};o[a]!==void 0&&(h.challenge_id=o[a].id,h.solved=o[a].solved_by_me),d.push(h),a++}for(e.push(d);a<=n;){const l=[];for(let h=1;h<8;h++){if(a>n)l.push({status:"NOT_CALENDAR_MONTH"});else if(h>5&&window.init.themeSettings.challOnWE=="false")l.push({status:"NO_CHALL_WE",date:a});else if(a<=window.init.themeSettings.lastDayOfCalendar){const g={status:"CHALL",date:a};o[a]!==void 0&&(g.challenge_id=o[a].id,g.solved=o[a].solved_by_me),l.push(g)}else l.push({status:"NO_CHALL_AFTER_CHRISTMAS",date:a});a++}e.push(l)}return e},async loadChallenges(){this.challenges=await s.pages.challenges.getChallenges()},async loadChallenge(e){await s.pages.challenge.displayChallenge(e,t=>{t.data.view=c(t.data.view),i.store("challenge").data=t.data,i.nextTick(()=>{let n=f.getOrCreateInstance("[x-ref='challengeWindow']");n._element.addEventListener("hidden.bs.modal",a=>{history.replaceState(null,null," ")},{once:!0}),n.show(),history.replaceState(null,null,`#${t.data.name}-${e}`)})})}}));i.start();
